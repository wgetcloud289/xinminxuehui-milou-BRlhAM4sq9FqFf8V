[åˆé›† \- æœºå™¨å­¦ä¹ (4\)](https://github.com)[1\.ä»é›¶å¼€å§‹å­¦æœºå™¨å­¦ä¹ â€”â€”ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ 09\-24](https://github.com/guoxiaoyu/p/18412875)[2\.ä»é›¶å¼€å§‹å­¦æœºå™¨å­¦ä¹ â€”â€”äº†è§£å›å½’09\-25](https://github.com/guoxiaoyu/p/18413894):[è“çŒ«æœºåœº](https://fenfang.org)[3\.ä»é›¶å¼€å§‹å­¦æœºå™¨å­¦ä¹ â€”â€”å‡†å¤‡å’Œå¯è§†åŒ–æ•°æ®09\-27](https://github.com/guoxiaoyu/p/18419035)4\.ä»é›¶å¼€å§‹å­¦æœºå™¨å­¦ä¹ â€”â€”çº¿æ€§å’Œå¤šé¡¹å¼å›å½’09\-29æ”¶èµ·
é¦–å…ˆç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å­¦ä¹ åœ°å€ï¼š[https://cloudstudio.net/columns](https://github.com)


åœ¨ä¹‹å‰çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹æ•°æ®çš„å‡†å¤‡å·¥ä½œä»¥åŠæ•°æ®å¯è§†åŒ–æœ‰äº†ä¸€å®šçš„äº†è§£ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨åŸºæœ¬çº¿æ€§å›å½’å’Œå¤šé¡¹å¼å›å½’çš„æ¦‚å¿µä¸åº”ç”¨ã€‚


å¦‚æœåœ¨è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°ä¸€äº›æ•°å­¦çŸ¥è¯†ï¼Œå¤§å®¶ä¹Ÿä¸å¿…æ„Ÿåˆ°ç•æƒ§ï¼Œæˆ‘ä¼šé€æ­¥ä¸ºå¤§å®¶è¿›è¡Œè¯¦ç»†çš„è®²è§£ï¼Œä»¥ä¾¿å¤§å®¶èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£è¿™äº›å†…å®¹ã€‚å¸Œæœ›é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œèƒ½å¤Ÿå¸®åŠ©å¤§å®¶å»ºç«‹èµ·å¯¹è¿™ä¸¤ç§å›å½’æ–¹æ³•çš„æ¸…æ™°è®¤è¯†ï¼Œå¹¶æŒæ¡å®ƒä»¬åœ¨å®é™…é—®é¢˜ä¸­çš„åº”ç”¨ã€‚


# çº¿æ€§å’Œå¤šé¡¹å¼å›å½’


é€šå¸¸æƒ…å†µä¸‹ï¼Œå›å½’åˆ†æä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šçº¿æ€§å›å½’å’Œå¤šé¡¹å¼å›å½’ã€‚çº¿æ€§å›å½’æ—¨åœ¨é€šè¿‡ä¸€æ¡ç›´çº¿æ¥æè¿°å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œè€Œå¤šé¡¹å¼å›å½’åˆ™å…è®¸æˆ‘ä»¬ä½¿ç”¨å¤šé¡¹å¼å‡½æ•°æ¥æ›´çµæ´»åœ°æ•æ‰æ•°æ®çš„å¤æ‚è¶‹åŠ¿ã€‚ä¸ºäº†å¸®åŠ©å¤§å®¶ç›´è§‚åœ°ç†è§£è¿™ä¸¤ç§å›å½’æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å›¾ç‰‡è¿›è¡Œå±•ç¤ºã€‚


![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080029676-1561876230.png)


å…¶å®ï¼Œçº¿æ€§å›å½’å’Œå¤šé¡¹å¼å›å½’ä¹‹é—´çš„åŒºåˆ«ï¼Œå¯ä»¥ç®€å•åœ°å½’ç»“ä¸ºç›´çº¿ä¸æ›²çº¿çš„å·®å¼‚ã€‚


## åŸºæœ¬çº¿æ€§å›å½’


çº¿æ€§å›å½’ç»ƒä¹ çš„ç›®æ ‡åœ¨äºèƒ½å¤Ÿç»˜åˆ¶å‡ºä¸€æ¡ç†æƒ³çš„å›å½’çº¿ï¼Œé‚£ä¹ˆä»€ä¹ˆæ‰ç®—æ˜¯â€œå®Œç¾çš„çº¿â€å‘¢ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œå®Œç¾çš„çº¿æ˜¯æŒ‡ä½¿æ‰€æœ‰åˆ†æ•£çš„æ•°æ®ç‚¹åˆ°è¿™æ¡çº¿çš„è·ç¦»æœ€çŸ­çš„æƒ…å†µã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚


ç†æƒ³æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ€»å’Œåº”å°½å¯èƒ½å°ï¼Œä»¥ç¡®ä¿å›å½’çº¿èƒ½å¤Ÿæœ€ä½³åœ°ä»£è¡¨æ•°æ®çš„è¶‹åŠ¿ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ç›¸å…³çš„æ•°å­¦å…¬å¼ï¼Œä»¥ä¾¿æ›´æ·±å…¥åœ°ç†è§£è¿™ä¸€è¿‡ç¨‹ã€‚


sumni\=1(yiâˆ’f(xi))2sumi\=1n(yiâˆ’f(xi))2


æˆ‘ä»¬å¸Œæœ›æ±‚å‡ºä¸€ç»„æœªçŸ¥å‚æ•°ï¼Œä½¿å¾—æ ·æœ¬ç‚¹ä¸æ‹Ÿåˆçº¿ä¹‹é—´çš„æ€»è¯¯å·®ï¼ˆå³è·ç¦»ï¼‰æœ€å°åŒ–ã€‚æœ€ç›´è§‚çš„æ„Ÿå—å¦‚ä¸‹å›¾ï¼š


![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080035831-3456536.png)


å› ä¸ºç›¸å‡çš„ç»“æœå¯èƒ½ä¼šå‡ºç°è´Ÿæ•°çš„æƒ…å†µï¼Œä¸ºäº†ç¡®ä¿æˆ‘ä»¬è®¡ç®—å‡ºçš„å€¼å§‹ç»ˆä¸ºæ­£ï¼Œå› æ­¤åœ¨è¿™é‡Œå¼•å…¥äº†å¹³æ–¹çš„æ¦‚å¿µã€‚æ— è®ºå‡æ³•çš„ç»“æœæ˜¯æ­£è¿˜æ˜¯è´Ÿï¼Œç»è¿‡å¹³æ–¹å¤„ç†åï¼Œæ‰€æœ‰çš„ç»“æœéƒ½å°†è½¬åŒ–ä¸ºæ­£æ•°ã€‚


è¿™æ¡ç»¿çº¿è¢«ç§°ä¸ºæœ€ä½³æ‹Ÿåˆçº¿ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ•°å­¦ç­‰å¼æ¥è¡¨ç¤ºï¼š


`Y = a + bX`


X æ˜¯â€œè§£é‡Šå˜é‡â€ã€‚Y æ˜¯â€œå› å˜é‡â€ã€‚ç›´çº¿çš„æ–œç‡æ˜¯ bï¼Œa æ˜¯ y è½´æˆªè·ï¼ŒæŒ‡çš„æ˜¯ X \= 0 æ—¶ Y çš„å€¼ã€‚


ä¸€ä¸ªå¥½çš„çº¿æ€§å›å½’æ¨¡å‹å°†æ˜¯ä¸€ä¸ªç”¨æœ€å°äºŒä¹˜å›å½’æ³•ä¸ç›´çº¿å›å½’å¾—åˆ°çš„é«˜ï¼ˆæ›´æ¥è¿‘äº 1ï¼‰ç›¸å…³ç³»æ•°çš„æ¨¡å‹ã€‚ç›¸å…³ç³»æ•°ï¼ˆä¹Ÿç§°ä¸ºçš®å°”é€Šç›¸å…³ç³»æ•°ï¼‰æˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼š


![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080042087-731762923.png)


æˆ‘ä»¬å¯ä»¥å‘ç°ç›¸å…³ç³»æ•°åæ˜ çš„æ˜¯å˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»å’Œç›¸å…³æ€§çš„æ–¹å‘ï¼ˆç¬¬ä¸€æ’ï¼‰ï¼Œè€Œä¸æ˜¯ç›¸å…³æ€§çš„æ–œç‡ï¼ˆä¸­é—´ï¼‰ï¼Œä¹Ÿä¸æ˜¯å„ç§éçº¿æ€§å…³ç³»ï¼ˆç¬¬ä¸‰æ’ï¼‰ã€‚è¯·æ³¨æ„ï¼šä¸­é—´çš„å›¾ä¸­æ–œç‡ä¸º0ï¼Œä½†ç›¸å…³ç³»æ•°æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºæ­¤æ—¶å˜é‡æ˜¯0ã€‚


## å·¥å…·åˆ†æ


å½“ç„¶ï¼Œç›¸å…³æ€§è¿™ç§æŒ‡æ ‡çš„æ‰‹åŠ¨è®¡ç®—å¹¶ä¸å®é™…ï¼Œå°¤å…¶æ˜¯åœ¨é¢å¯¹å¤§è§„æ¨¡æ•°æ®æ—¶ï¼Œæ‰‹åŠ¨å¤„ç†ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚å› æ­¤ï¼Œåˆ©ç”¨ç°æœ‰çš„æ¡†æ¶ï¼Œå¦‚Scikit\-learnï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆã€å‡†ç¡®åœ°è¿›è¡Œç›¸å…³æ€§åˆ†æï¼Œè®©æˆ‘ä»¬ä¸“æ³¨äºæ›´é‡è¦çš„ä»»åŠ¡ã€‚



> pip install scikit\-learn



```
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from datetime import datetime
from sklearn.preprocessing import LabelEncoder

pumpkins = pd.read_csv('../data/US-pumpkins.csv')

pumpkins.head()

```

åœ¨è·å–æ ·æœ¬æ•°æ®åï¼Œè¿›è¡Œåˆ†ææ—¶ï¼Œé€šå¸¸éœ€è¦ç­›é€‰å‡ºæˆ‘ä»¬éœ€è¦çš„å­—æ®µï¼Œè€Œé‚£äº›ä¸éœ€è¦çš„åˆ™åº”äºˆä»¥ä¸¢å¼ƒï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ·±å…¥åˆ†æã€‚



```
pumpkins = pumpkins[pumpkins['Package'].str.contains('bushel', case=True, regex=True)]

columns_to_select = ['Package', 'Variety', 'City Name', 'Low Price', 'High Price', 'Date']
pumpkins = pumpkins.loc[:, columns_to_select]

price = (pumpkins['Low Price'] + pumpkins['High Price']) / 2

month = pd.DatetimeIndex(pumpkins['Date']).month
day_of_year = pd.to_datetime(pumpkins['Date']).apply(lambda dt: (dt-datetime(dt.year,1,1)).days)

new_pumpkins = pd.DataFrame(
    {'Month': month, 
     'DayOfYear' : day_of_year, 
     'Variety': pumpkins['Variety'], 
     'City': pumpkins['City Name'], 
     'Package': pumpkins['Package'], 
     'Low Price': pumpkins['Low Price'],
     'High Price': pumpkins['High Price'], 
     'Price': price})

new_pumpkins.loc[new_pumpkins['Package'].str.contains('1 1/9'), 'Price'] = price/1.1
new_pumpkins.loc[new_pumpkins['Package'].str.contains('1/2'), 'Price'] = price*2
new_pumpkins.iloc[:, 0:-1] = new_pumpkins.iloc[:, 0:-1].apply(LabelEncoder().fit_transform)

new_pumpkins.head()

```

å°½ç®¡ä»£ç å¯èƒ½ä¼šè®©äººæ„Ÿåˆ°å›°æƒ‘ï¼Œå…¶æ ¸å¿ƒé€»è¾‘å…¶å®å¾ˆç®€å•ï¼šæˆ‘ä»¬åªéœ€æå–å‡ºæ‰€éœ€çš„å­—æ®µï¼ŒåŒ…æ‹¬å¹´æœˆã€ä»·æ ¼ã€åŸå¸‚å’ŒåŒ…è£…ä¿¡æ¯ã€‚å¦‚æœä½ å¯¹ç¼–ç¨‹ä¸å¤ªç†Ÿæ‚‰ï¼Œä¹Ÿå®Œå…¨æ²¡å…³ç³»ï¼Œç°åœ¨æœ‰å¾ˆå¤šä»£ç åŠ©æ‰‹å¯ä¾›ä½¿ç”¨ï¼Œé€‰ç”¨ä»»ä½•ä¸€ä¸ªéƒ½èƒ½è½»æ¾å†™å‡ºæ‰€éœ€çš„ä»£ç ã€‚å…³é”®åœ¨äºä¿æŒæ¸…æ™°çš„é€»è¾‘æ€è·¯ï¼Œè€Œä¸æ˜¯è¢«ä»£ç çš„å¤æ‚æ€§æ‰€å¹²æ‰°ã€‚



```
import matplotlib.pyplot as plt
plt.scatter('City','Price',data=new_pumpkins)

```

æ­£å¸¸æ¥è¯´ï¼ŒåŸå¸‚å­—æ®µåº”è¯¥æ˜¯æ–‡å­—ä¹Ÿå°±æ˜¯åŸå¸‚åå­—ï¼Œä½†æ˜¯å› ä¸ºè®¡ç®—çš„åŸå› ï¼Œè¿™é‡Œæœ‰ä¸€æ®µä»£ç `new_pumpkins.iloc[:, 0:-1] = new_pumpkins.iloc[:, 0:-1].apply(LabelEncoder().fit_transform)`å°†æ•°æ®é›†ä¸­çš„åˆ†ç±»å˜é‡è½¬æ¢ä¸ºæ•°å€¼å˜é‡ï¼Œä»¥ä¾¿äºåç»­çš„æœºå™¨å­¦ä¹ å»ºæ¨¡ã€‚


![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080050983-737422721.png)


å¦‚ä¸Šæ‰€ç¤ºçš„æ•ˆæœå›¾å±•ç¤ºäº†æˆ‘ä»¬çš„åˆæ­¥åˆ†æç»“æœã€‚å½“ç„¶ï¼Œä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä¸€ä¸ªå­—æ®µæ¥è¿›è¡Œä»·æ ¼çš„å–ç‚¹åˆ†æï¼Œä½†é€šè¿‡è‚‰çœ¼è§‚å¯Ÿï¼Œå¾€å¾€éš¾ä»¥å‘ç°å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ä¸è¿‡ï¼Œè¿™å¹¶ä¸æˆé—®é¢˜ï¼Œå› ä¸ºç°åœ¨æœ‰å¾ˆå¤šå¼ºå¤§çš„å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ·±å…¥çš„æ•°æ®åˆ†æã€‚



```
print(new_pumpkins['City'].corr(new_pumpkins['Price']))
# 0.32363971816089226

```

ç¡®å®ï¼Œæ•´ä¸ªè¿‡ç¨‹ç®€å•æ˜äº†ï¼Œä¸€å¥è¯å°±å¯ä»¥æ¦‚æ‹¬ã€‚æ¥ä¸‹æ¥ï¼Œåªéœ€å°†å‰©ä½™çš„åˆ†æä»»åŠ¡äº¤ç»™æ¡†æ¶å³å¯ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ç›¸å…³æ€§å¤§çº¦åªæœ‰0\.3ï¼Œæ˜¾ç¤ºå‡ºä¸1çš„è·ç¦»ç›¸å½“æ˜æ˜¾ï¼Œè¿™æ„å‘³ç€å˜é‡ä¹‹é—´çš„å…³ç³»å¹¶ä¸å¼ºã€‚


å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ›´æ¢å¦ä¸€ä¸ªå­—æ®µæ¥å¯¹ä»·æ ¼è¿›è¡Œåˆ†æï¼Œä»¥è¿›ä¸€æ­¥æ¢è®¨ä¸åŒå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚



```
print(new_pumpkins['Package'].corr(new_pumpkins['Price']))
# 0.6061712937226021

```

![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080057150-803192661.png)


æˆ‘ä»¬æ¸…æ¥šï¼Œå½±å“ä»·æ ¼çš„å› ç´ æœ‰å¾ˆå¤šï¼Œå› æ­¤æ¯æ¬¡éƒ½å•ç‹¬å°è¯•æ›´æ¢å­—æ®µå¹¶è¿è¡Œä»£ç ï¼Œä»¥åˆ¤æ–­å“ªä¸ªå­—æ®µä¸ä»·æ ¼çš„ç›¸å…³æ€§æœ€é«˜ï¼Œæ˜¾å¾—ååˆ†ç¹çå’Œä½æ•ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸€ç§æ›´ä¸ºé«˜æ•ˆçš„æ–¹æ³•â€”â€”æ„é€ çƒ­åŠ›å›¾ã€‚



```
corr = poly_pumpkins.corr()
corr.style.background_gradient(cmap='coolwarm')

```

ä»£ç å…¶å®éå¸¸ç®€å•ï¼Œä»…éœ€ä¸¤è¡Œå°±èƒ½å®ç°æˆ‘ä»¬çš„ç›®æ ‡ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä¸€èµ·è§‚å¯Ÿè¿è¡Œç»“æœï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¿™äº›ä»£ç çš„æ•ˆæœå’Œè¾“å‡ºã€‚


![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080103140-750882653.png)


æ ¹æ®è¿™äº›ç›¸å…³æ€§ç³»æ•°ï¼Œä½ å¯ä»¥ç›´è§‚åœ°çœ‹åˆ° Package å’Œ Price ä¹‹é—´çš„è‰¯å¥½ç›¸å…³æ€§ã€‚


### å›å½’æ¨¡å‹


åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥åˆæ­¥ç¡®è®¤ï¼ŒåŒ…è£…æ–¹å¼çš„ä»·æ ¼ä¸åŸå¸‚åœ°åŒºåˆ†å¸ƒçš„ä»·æ ¼ç›¸æ¯”ï¼Œæ›´å…·ç›¸å…³æ€§ã€‚è¿™ä¸€å‘ç°ä¸ºæˆ‘ä»¬çš„åˆ†æå¥ å®šäº†åŸºç¡€ï¼Œå› æ­¤æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»¥åŒ…è£…æ–¹å¼ä¸ºæ ¸å¿ƒï¼Œåˆ›å»ºä¸€ä¸ªå›å½’æ¨¡å‹ã€‚



```
new_columns = ['Package', 'Price']
lin_pumpkins = new_pumpkins.drop([c for c in new_pumpkins.columns if c not in new_columns], axis='columns')
X = lin_pumpkins.values[:, :1]
y = lin_pumpkins.values[:, 1:2]

```

åŒæ ·çš„ï¼Œæˆ‘ä»¬åªè¦åŒ…è£…å’Œä»·æ ¼å­—æ®µå³å¯ã€‚è®©åå–ç¬¬ä¸€åˆ—ä¸ºXè½´æ•°æ®ï¼Œç¬¬äºŒåˆ—ä¸ºYè½´æ•°æ®ã€‚


æ¥ä¸‹æ¥ï¼Œå¼€å§‹æ„å»ºå›å½’æ¨¡å‹ï¼Œå’Œç¬¬ä¸€èŠ‚å·®ä¸å¤šï¼Œä»ç„¶æ˜¯ä»æ ·æœ¬æ€»æŠ½å–æµ‹è¯•é›†ä»¥åŠè®­ç»ƒé›†ï¼Œä½¿ç”¨Pythonçš„scikit\-learnåº“æ¥è®­ç»ƒä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼Œå¹¶å¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹ï¼Œä»£ç å†å†™ä¸€æ¬¡ï¼š



```
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_squared_error, mean_absolute_error
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
lin_reg = LinearRegression()
lin_reg.fit(X_train,y_train)

pred = lin_reg.predict(X_test)

accuracy_score = lin_reg.score(X_train,y_train)
print('Model Accuracy: ', accuracy_score)
# Model Accuracy:  0.3315342327998987

```

æˆ‘æ¥ç®€å•çš„è§£é‡Šä¸€ä¸‹ï¼š


* å°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
* åˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹å¹¶è®­ç»ƒå®ƒï¼Œæ˜¯çš„ï¼Œå°±ä¸¤è¡Œä»£ç å®Œæˆäº†è®­ç»ƒï¼Œéƒ½ä¸ç”¨æˆ‘ä»¬è‡ªå·±å†™ä»€ä¹ˆä¸œè¥¿ã€‚
* ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹å¯¹æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹
* è®¡ç®—å¹¶æ‰“å°æ¨¡å‹çš„å‡†ç¡®åº¦


æœ€ç»ˆçš„åˆ†æ•°ç¡®å®ä¸æ˜¯å¾ˆé«˜ï¼Œæ¯•ç«Ÿç›¸å…³æ€§ä¹Ÿä¸æ˜¯å¾ˆå¥½ã€‚


æˆ‘ä»¬å¯ä»¥å¯¹å·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œå¯è§†åŒ–ï¼Œä»¥æ›´ç›´è§‚åœ°å±•ç¤ºå…¶æ€§èƒ½å’Œé¢„æµ‹ç»“æœã€‚



```
plt.scatter(X_test, y_test,  color='black')
plt.plot(X_test, pred, color='blue', linewidth=3)

plt.xlabel('Package')
plt.ylabel('Price')

plt.show()

```

![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080114077-2019534007.png)


è¿™æ ·ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå°±æˆåŠŸå®ç°äº†ä¸€ä¸ªåŸºç¡€çš„çº¿æ€§å›å½’æ¨¡å‹ã€‚


## å¤šé¡¹å¼å›å½’


å¦ä¸€ç§é‡è¦çš„çº¿æ€§å›å½’ç±»å‹æ˜¯å¤šé¡¹å¼å›å½’ã€‚å°½ç®¡åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å˜é‡ä¹‹é—´å­˜åœ¨ç›´æ¥çš„çº¿æ€§å…³ç³»â€”â€”ä¾‹å¦‚ï¼Œå—ç“œçš„ä½“ç§¯è¶Šå¤§ï¼Œä»·æ ¼é€šå¸¸ä¹Ÿä¼šéšä¹‹ä¸Šæ¶¨â€”â€”ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ç§å…³ç³»å¯èƒ½æ— æ³•ç®€å•åœ°ç”¨å¹³é¢æˆ–ç›´çº¿æ¥è¡¨ç¤ºã€‚


æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çš„å›¾ä¾‹ä¸­æ‰€è§ï¼Œå¦‚æœæˆ‘ä»¬çš„æ¨¡å‹é‡‡ç”¨æ›²çº¿è€Œéç›´çº¿ï¼Œè¿™å¯èƒ½æ›´æœ‰æ•ˆåœ°è´´åˆæ•°æ®ç‚¹çš„åˆ†å¸ƒï¼Œä»è€Œæ›´å‡†ç¡®åœ°æ•æ‰å˜é‡ä¹‹é—´çš„å¤æ‚å…³ç³»ã€‚



```
new_columns = ['Variety', 'Package', 'City', 'Month', 'Price']
poly_pumpkins = new_pumpkins.drop([c for c in new_pumpkins.columns if c not in new_columns], axis='columns')

```

æˆ‘ä»¬é‡æ–°çœ‹ä¸‹æ•°æ®ï¼Œç„¶åç›´æ¥æ‹¿å‡ºPackageå’ŒPriceå€¼ã€‚



```
X=poly_pumpkins.iloc[:,3:4].values
y=poly_pumpkins.iloc[:,4:5].values

```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç›´æ¥è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¦ä¸€ä¸ªAPIï¼Œå³scikit\-learnåº“ï¼Œæ¥æ„å»ºä¸€ä¸ªåŒ…å«å¤šé¡¹å¼ç‰¹å¾è½¬æ¢å’Œçº¿æ€§å›å½’æ¨¡å‹çš„ç®¡é“ï¼ˆpipelineï¼‰ã€‚è¿™ä¸ªç®¡é“çš„è®¾è®¡æ—¨åœ¨ç®€åŒ–æ•°æ®å¤„ç†æµç¨‹ï¼Œä½¿å¾—å¤šé¡¹å¼ç‰¹å¾çš„ç”Ÿæˆå’Œæ¨¡å‹çš„è®­ç»ƒèƒ½å¤Ÿé«˜æ•ˆåœ°ä¸²è”åœ¨ä¸€èµ·ã€‚



```
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import make_pipeline

pipeline = make_pipeline(PolynomialFeatures(4), LinearRegression())

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

pipeline.fit(np.array(X_train), y_train)

y_pred=pipeline.predict(X_test)

```

### PolynomialFeatures


åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³ç®€è¦ä»‹ç»ä¸€ä¸‹PolynomialFeaturesè¿™ä¸€åŠŸèƒ½ã€‚PolynomialFeaturesæ˜¯scikit\-learnåº“ä¸­ç”¨äºç”Ÿæˆå¤šé¡¹å¼ç‰¹å¾çš„å·¥å…·ã€‚


å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†è¾“å…¥çš„ç‰¹å¾è½¬æ¢ä¸ºå¤šé¡¹å¼å½¢å¼ï¼Œä»è€Œå…è®¸æˆ‘ä»¬åœ¨æ¨¡å‹ä¸­è€ƒè™‘å˜é‡ä¹‹é—´çš„éçº¿æ€§å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå•ä¸€ç‰¹å¾æ—¶ï¼Œä½¿ç”¨PolynomialFeatureså¯ä»¥åˆ›å»ºè¯¥ç‰¹å¾çš„å¹³æ–¹ã€ç«‹æ–¹ï¼Œç”šè‡³æ›´é«˜æ¬¡çš„ç‰¹å¾ã€‚


æˆ‘ä»¬çš„ä»£ç ä¸­å‚æ•°è®¾ç½®ä¸º4ï¼Œæ„å‘³ç€æˆ‘ä»¬å¸Œæœ›å¯¹è¾“å…¥ç‰¹å¾Xè¿›è¡Œå››æ¬¡å¤šé¡¹å¼è½¬æ¢ã€‚è¿™ç§è½¬æ¢å°†ä½¿å¾—æ¯ä¸ªåŸå§‹ç‰¹å¾ç”Ÿæˆå…¶å››æ¬¡å¹‚çš„ç»„åˆï¼Œä»è€Œä¸°å¯Œæˆ‘ä»¬çš„ç‰¹å¾é›†ã€‚


ä¸ºäº†å¸®åŠ©å¤§å®¶æ›´ç›´è§‚åœ°ç†è§£è¿™ä¸€è¿‡ç¨‹ï¼Œæˆ‘å°†æä¾›ä¸€ç»„ç¤ºä¾‹æ•°æ®ï¼Œå±•ç¤ºç»è¿‡PolynomialFeatureså¤„ç†åï¼ŒåŸæœ‰çš„Xç‰¹å¾æ•°æ®è¢«è½¬åŒ–æˆäº†ä»€ä¹ˆæ ·çš„å¤šé¡¹å¼ç‰¹å¾ã€‚



```
import numpy as np

X = np.array([1, 2, 3, 4, 5])
X = X.reshape(-1, 1)
X

```

è¿™æ˜¯æˆ‘ä»¬å½“å‰çš„ç‰¹å¾é›†Xï¼ŒåŒ…å«äº†ä¸€ç»„ç®€å•çš„æ•°æ®ç‚¹ã€‚



```
array([[1],
       [2],
       [3],
       [4],
       [5]])

```


```
pp = PolynomialFeatures(4)
X_poly = pp.fit_transform(X)
print(X_poly)

```

è½¬æ¢åä¼šç”Ÿæˆå¦‚ä¸‹ï¼š



```
[[  1.   1.   1.   1.   1.]
 [  1.   2.   4.   8.  16.]
 [  1.   3.   9.  27.  81.]
 [  1.   4.  16.  64. 256.]
 [  1.   5.  25. 125. 625.]]

```

è¿™æ ·åšçš„æ„ä¹‰å°±åœ¨äºï¼šçº¿æ€§å›å½’å‡è®¾ç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´çš„å…³ç³»æ˜¯çº¿æ€§çš„ã€‚é€šè¿‡å¤šé¡¹å¼ç‰¹å¾è½¬æ¢ï¼Œå¯ä»¥æ•æ‰æ›´å¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚è¿™æœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›ã€‚


åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å®é™…ä¸Šæ˜¯åœ¨å­¦ä¹ ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼Œä¸¾ä¸ªä¾‹å­ä¾‹å¦‚ï¼šäºŒæ¬¡å¤šé¡¹å¼ y\=ax2\+bx\+cy\=ax2\+bx\+c è¡¨ç¤ºä¸€ä¸ªæŠ›ç‰©çº¿ã€‚


é‚£ä¹ˆè¿™ä¸ªæ¨¡å‹è®­ç»ƒåå°±ä¼šäº§ç”Ÿå¦‚ä¸‹æ•ˆæœï¼š



```
df = pd.DataFrame({'x': X_test[:,0], 'y': y_pred[:,0]})
df.sort_values(by='x',inplace = True)
points = pd.DataFrame(df).to_numpy()

plt.plot(points[:, 0], points[:, 1],color="blue", linewidth=3)
plt.xlabel('Package')
plt.ylabel('Price')
plt.scatter(X,y, color="black")
plt.show()

```

![image](https://img2024.cnblogs.com/blog/1423484/202409/1423484-20240920080124474-608069521.png)


æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸ªéçº¿æ€§æ¨¡å‹è¿›è¡Œé¢„æµ‹å³å¯ã€‚ç®€å•æ¼”ç¤ºä¸€ä¸‹ï¼š



```
pipeline.predict( np.array([ [2.75] ]) )
# array([[46.34509342]])

```

# æ€»ç»“


åœ¨æ¢è®¨çº¿æ€§å›å½’å’Œå¤šé¡¹å¼å›å½’çš„æ—…ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…å­¦ä¹ äº†å¦‚ä½•æ„å»ºæ¨¡å‹ï¼Œè¿˜ç†è§£äº†èƒŒåçš„æ•°å­¦åŸç†å’Œåº”ç”¨åœºæ™¯ã€‚é€šè¿‡é€æ­¥å¼•å¯¼ï¼Œå¸Œæœ›å¤§å®¶å¯¹æ•°æ®åˆ†æçš„å¤æ‚æ€§æœ‰äº†æ›´æ·±çš„è®¤è¯†ã€‚æœªæ¥ï¼Œåœ¨å®é™…é—®é¢˜ä¸­çµæ´»åº”ç”¨è¿™äº›å›å½’æŠ€æœ¯ï¼Œå°†ä½¿æˆ‘ä»¬åœ¨æ•°æ®é©±åŠ¨çš„å†³ç­–ä¸­å æ®ä¼˜åŠ¿ã€‚


æ— è®ºæ˜¯é€‰æ‹©åˆé€‚çš„å›å½’æ–¹æ³•ï¼Œè¿˜æ˜¯è¿ç”¨å¼ºå¤§çš„å·¥å…·ï¼Œæˆ‘ä»¬éƒ½èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°ä»æ•°æ®ä¸­æç‚¼å‡ºæœ‰ä»·å€¼çš„è§è§£ã€‚æ¥ä¸‹æ¥ï¼ŒæœŸå¾…å¤§å®¶åœ¨å®è·µä¸­ä¸æ–­æ¢ç´¢ã€æ·±å…¥æŒ–æ˜ï¼Œæœ€ç»ˆå®ç°å¯¹æ•°æ®çš„æ·±åˆ»ç†è§£ä¸åº”ç”¨ã€‚




---


æˆ‘æ˜¯åŠªåŠ›çš„å°é›¨ï¼Œä¸€å Java æœåŠ¡ç«¯ç å†œï¼Œæ½œå¿ƒç ”ç©¶ç€ AI æŠ€æœ¯çš„å¥¥ç§˜ã€‚æˆ‘çƒ­çˆ±æŠ€æœ¯äº¤æµä¸åˆ†äº«ï¼Œå¯¹å¼€æºç¤¾åŒºå……æ»¡çƒ­æƒ…ã€‚åŒæ—¶ä¹Ÿæ˜¯ä¸€ä½è…¾è®¯äº‘åˆ›ä½œä¹‹æ˜Ÿã€é˜¿é‡Œäº‘ä¸“å®¶åšä¸»ã€åä¸ºäº‘äº‘äº«ä¸“å®¶ã€æ˜é‡‘ä¼˜ç§€ä½œè€…ã€‚


ğŸ’¡ æˆ‘å°†ä¸ååˆ†äº«æˆ‘åœ¨æŠ€æœ¯é“è·¯ä¸Šçš„ä¸ªäººæ¢ç´¢ä¸ç»éªŒï¼Œå¸Œæœ›èƒ½ä¸ºä½ çš„å­¦ä¹ ä¸æˆé•¿å¸¦æ¥ä¸€äº›å¯å‘ä¸å¸®åŠ©ã€‚


ğŸŒŸ æ¬¢è¿å…³æ³¨åŠªåŠ›çš„å°é›¨ï¼ğŸŒŸ


